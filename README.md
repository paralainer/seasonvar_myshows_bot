*WARNING*
A lot of shit code here, do not use as best practice :)